1 EVENT: startup
NEW: <ConditionalWorkSequence:1 (4)>
   : │  EVENT: startup
   : └1╴... done.
1 EVENT: startup
1 END: startup
0 add ‹IfStatement if¦exists¦state¦foo¦bar›
0 add ‹LogHandler log¦TRACE¦No‽›
0 add ‹LogHandler log¦TRACE¦Yes!›
0 Yes!
0 Set to ONE
20 EVENT: state¦-¦one¦foo¦bar
NEW: <ConditionalWorkSequence:2 (4)>
   : │  EVENT: state¦-¦one¦foo¦bar
   : └1╴... done.
20 EVENT: state¦-¦one¦foo¦bar
20 END: state¦-¦one¦foo¦bar
0 Set to TWO
31 EVENT: state¦one¦two¦foo¦bar
NEW: <ConditionalWorkSequence:3 (4)>
   : │  EVENT: state¦one¦two¦foo¦bar
   : └1╴... done.
31 EVENT: state¦one¦two¦foo¦bar
31 END: state¦one¦two¦foo¦bar
0 Create OnEvtHandler: state¦*¦three¦foo¦bar
0 add ‹LogHandler log¦TRACE¦Set¦to¦FOUR›
0 add ‹SetStateHandler set¦state¦four¦foo¦bar›
0 NewHandler 1
0 add ‹LogHandler log¦TRACE¦Set¦to¦THREE›
0 add ‹SetStateHandler set¦state¦three¦foo¦bar›
49 EVENT: wait¦start¦0.1¦_wait¦1
NEW: <ConditionalWorkSequence:4 (4)>
   : │  EVENT: wait¦start¦0.1¦_wait¦1
   : └1╴... done.
49 EVENT: wait¦start¦0.1¦_wait¦1
49 END: wait¦start¦0.1¦_wait¦1
0 Set to THREE
58 EVENT: state¦two¦three¦foo¦bar
NEW: <ConditionalWorkSequence:5 (5)>
   : │  EVENT: state¦two¦three¦foo¦bar
   : ├1╴on state * three foo bar ‹OnEventHandler›
   : │  prio: 51
   : │  step: log TRACE Set to FOUR ‹LogHandler›
   : │  step: set state four foo bar ‹SetStateHandler›
   : └2╴... done.
58 EVENT: state¦two¦three¦foo¦bar
RUN: on state * three foo bar ‹OnEventHandler›
   : prio: 51
   : step: log TRACE Set to FOUR ‹LogHandler›
   : step: set state four foo bar ‹SetStateHandler›
 at: <ConditionalWorkSequence:5 (5)> (step 1)
 ev: EVENT: state¦two¦three¦foo¦bar
0 Set to FOUR
58 END: state¦two¦three¦foo¦bar
ERROR: Traceback (most recent call last):
     :   File "homevent/twist.py, in <lambda>
     :     d.addCallback(lambda _: p(*a,**k))
     :   File "internet/defer.py, in unwindGenerator
     :     return _inlineCallbacks(None, f(*args, **kwargs), Deferred())
     :   File "internet/defer.py, in _inlineCallbacks
     :     result = g.throw(result.type, result.value, result.tb)
     :   File "homevent/worker.py, in _process
     :     r = failure.Failure()
     : --- <exception caught here> ---
     :   File "homevent/worker.py, in _process
     :     r = yield w.process(event=self.event, queue=self)
     :   File "internet/defer.py, in _runCallbacks
     :     self.result = callback(self.result, *args, **kw)
     :   File "homevent/statement.py, in go
     :     return p.run(ctx)
     :   File "modules/state.py, in run
     :     raise StateChangeError(s,value)
     : __builtin__.StateChangeError: Trying to change state to 'four' while changing from 'two' to 'three'
   in: on state * three foo bar ‹OnEventHandler›
     : prio: 51
     : step: log TRACE Set to FOUR ‹LogHandler›
     : step: set state four foo bar ‹SetStateHandler›
   in: <ConditionalWorkSequence:5 (5)>
     : │  EVENT: state¦two¦three¦foo¦bar
     : ╞1╕on state * three foo bar ‹OnEventHandler›
     : │ │prio: 51
     : │ │step: log TRACE Set to FOUR ‹LogHandler›
     : │ ╵step: set state four foo bar ‹SetStateHandler›
     : └2╴... done.
NEW: <WorkSequence:6 (4)>
   : │  ERROR: Trying to change state to 'four' while changing from 'two' to 'three'
   : └1╴... done.
ERROR: Traceback (most recent call last):
     :   File "homevent/twist.py, in <lambda>
     :     d.addCallback(lambda _: p(*a,**k))
     :   File "internet/defer.py, in unwindGenerator
     :     return _inlineCallbacks(None, f(*args, **kwargs), Deferred())
     :   File "internet/defer.py, in _inlineCallbacks
     :     result = g.throw(result.type, result.value, result.tb)
     :   File "homevent/worker.py, in _process
     :     r = failure.Failure()
     : --- <exception caught here> ---
     :   File "homevent/worker.py, in _process
     :     r = yield w.process(event=self.event, queue=self)
     :   File "internet/defer.py, in _runCallbacks
     :     self.result = callback(self.result, *args, **kw)
     :   File "homevent/statement.py, in go
     :     return p.run(ctx)
     :   File "modules/state.py, in run
     :     raise StateChangeError(s,value)
     : __builtin__.StateChangeError: Trying to change state to 'four' while changing from 'two' to 'three'
   in: on state * three foo bar ‹OnEventHandler›
     : prio: 51
     : step: log TRACE Set to FOUR ‹LogHandler›
     : step: set state four foo bar ‹SetStateHandler›
   in: <ConditionalWorkSequence:5 (5)>
     : │  EVENT: state¦two¦three¦foo¦bar
     : ╞1╕on state * three foo bar ‹OnEventHandler›
     : │ │prio: 51
     : │ │step: log TRACE Set to FOUR ‹LogHandler›
     : │ ╵step: set state four foo bar ‹SetStateHandler›
     : └2╴... done.
72 END: StateChangeError
74 EVENT: wait¦done¦0.1¦_wait¦1
NEW: <ConditionalWorkSequence:7 (4)>
   : │  EVENT: wait¦done¦0.1¦_wait¦1
   : └1╴... done.
74 EVENT: wait¦done¦0.1¦_wait¦1
74 END: wait¦done¦0.1¦_wait¦1
foo bar :: three
.
value: three
lock: No
last value: two
.
0 add ‹IfStatement if¦state¦three¦foo¦bar›
0 add ‹LogHandler log¦TRACE¦Yes!›
0 add ‹LogHandler log¦TRACE¦No‽›
0 Yes!
0 add ‹IfStatement if¦exists¦state¦foo¦bar›
0 add ‹LogHandler log¦TRACE¦Yes!›
0 add ‹LogHandler log¦TRACE¦No‽›
0 Yes!
0 add ‹IfStatement if¦last¦state¦two¦foo¦bar›
0 add ‹LogHandler log¦TRACE¦Yes!›
0 add ‹LogHandler log¦TRACE¦No‽›
0 Yes!
0 Create OnEvtHandler: whatever
0 add ‹VarStateHandler var¦state¦x¦foo¦bar›
0 add ‹LogHandler log¦TRACE¦We¦got¦$x›
0 NewHandler 2
112 EVENT: whatever
NEW: <ConditionalWorkSequence:8 (5)>
   : │  EVENT: whatever
   : ├1╴on whatever ‹OnEventHandler›
   : │  prio: 51
   : │  step: var state x foo bar ‹VarStateHandler›
   : │  step: log TRACE We got $x ‹LogHandler›
   : └2╴... done.
112 EVENT: whatever
RUN: on whatever ‹OnEventHandler›
   : prio: 51
   : step: var state x foo bar ‹VarStateHandler›
   : step: log TRACE We got $x ‹LogHandler›
 at: <ConditionalWorkSequence:8 (5)> (step 1)
 ev: EVENT: whatever
0 We got three
112 END: whatever
124 EVENT: state¦three¦-¦foo¦bar
NEW: <ConditionalWorkSequence:9 (4)>
   : │  EVENT: state¦three¦-¦foo¦bar
   : └1╴... done.
124 EVENT: state¦three¦-¦foo¦bar
124 END: state¦three¦-¦foo¦bar
.
2 EVENT: shutdown
NEW: <ConditionalWorkSequence:10 (6)>
   : │  EVENT: shutdown
   : └1╴... done.
2 EVENT: shutdown
2 END: shutdown
